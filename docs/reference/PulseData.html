<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create an object for pulse-change count data — PulseData • pulseR</title>

<link rel="shortcut icon" type="image/x-icon" href="../favicon.ico">

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.1/clipboard.min.js" integrity="sha256-hIvIxeqhGZF+VVeM55k0mJvWpQ6gTkWk3Emc+NmowYA=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Create an object for pulse-change count data — PulseData" />

<meta property="og:description" content="Create an object for pulse-change count data" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pulseR</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/workflow.html">The workflow</a>
    </li>
    <li>
      <a href="../articles/epitranscriptomics.html">Analysis of RNA modifications</a>
    </li>
    <li>
      <a href="../articles/confidence.html">Profile likelihood</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/dieterich-lab/pulseR">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create an object for pulse-change count data</h1>
    <small class="dont-index">Source: <a href='https://github.com/dieterich-lab/pulseR/blob/master/R/pulseData.R'><code>R/pulseData.R</code></a></small>
    <div class="hidden name"><code>PulseData.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Create an object for pulse-change count data</p>
    
    </div>

    <pre class="usage"><span class='fu'>PulseData</span>(<span class='no'>counts</span>, <span class='no'>conditions</span>, <span class='no'>formulas</span>, <span class='kw'>formulaIndexes</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>spikeins</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>groups</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>counts</th>
      <td><p>a matrix; column names correspond to sample names.
The columns in <code>counts</code> correspond to the rows in <code>conditions</code> argument.</p></td>
    </tr>
    <tr>
      <th>conditions</th>
      <td><p>a data.frame;
the first column corresponds to the conditions given in <code>formulas</code>.
The order of rows corresponds to the columns (samples) in the
<code>counts</code> argument.</p></td>
    </tr>
    <tr>
      <th>formulas</th>
      <td><p>a list, created by <code><a href='MeanFormulas.html'>MeanFormulas</a></code></p></td>
    </tr>
    <tr>
      <th>formulaIndexes</th>
      <td><p>a list of lists (or of vectors);
defines indexes of formulas used for calculation of the expected read number.</p></td>
    </tr>
    <tr>
      <th>spikeins</th>
      <td><p>NULL (default) or a list of two items:</p><ul>
<li><p>refGroup, a character, which defines the group which should be
treated as a reference for normalisation</p></li>
<li><p>spikeLists, a list of character vectors with the spike-ins names and
the same structure as <code>formulaIndexes</code>.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>groups</th>
      <td><p>NULL (default) or a vector or a formula,
e.g. ~ fraction + time.
If the normalisation factors must be recovered during fitting,
<code>groups</code> define the sets of the samples, which share the same normalisation
factors. Hence <code>groups</code> is relevant only, if there were no spike-ins provided.
In this case, one may assume that for the samples of the same nature, i.e.
same fraction and labelling time, the efficiency of the purification is the
same, which reduces the number of parameters to fit. However, it is possible
to treat every sample as an individual group, hence there will be no shared
parameters.</p>
<p>If it is NULL, <code>groups</code> are derived from the first column of the <code>conditions</code>.
If a vector is provided, its elements correspond to the rows (samples) in the
<code>conditions</code>.
If, for example, there are 3 pull-down (2hr) samples purified with the protocol
"A", and 3 pull-down (2hr) samples from the protocol "B", one may assume different
efficiency of this protocols and reflect it in the <code>groups</code> argument by
introducing additional column <code>protocol</code> in the condition matrix, which results in
<code>groups = ~ fraction + time + protocol</code>.
Alternatively, one may manually create a vector like
<code>c("pull_down.2hr.A", "pull_down.2hr.B", ...)</code> with the order, corresponding
to the sample order in the <code>conditions</code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>an object of class "PulseData"</p>
<p>It is a list with the following slots:</p><ul>
<li><p><code>user_conditions</code>, <code>user_formulas</code>, <code>counts</code> are the values of arguments
<code>conditions</code>, <code>formulas</code> and <code>counts</code>, provided to the call of <code>PulseData</code></p></li>
<li><p><code>rawFormulas</code> is a list of initial formulas, evaluated at the
corresponding conditions (e.g. <code>time</code> in formulas is substituted with
its values in the <code>conditions$time</code>).</p></li>
<li><p><code>formulas</code> is a list of the compiled <code>rawFormulas</code></p></li>
<li><p><code>formulaIndexes</code> is a list of integers (or vectors) with indexes of formulas
used in estimation of the expression level in a given sample.
The order of list items corresponds to the order of the samples in the
<code>conditions</code> data.frame. See also <code><a href='addKnownToFormulas.html'>addKnownToFormulas</a></code>.</p></li>
<li><p><code>groups</code> is a vector with the names of the sample groups, which is used to
calculate normalisation factors.</p></li>
<li><p><code>depthNormalisation</code> is a list of normalisation factors of the same structure as
<code>formulaIndexes</code>. If no spike-ins are used, these values correspond
to sequencing depth within a given group of samples according to the
<code>groups</code> vector. For example, depth normalisation for a group "pull_down.2hr"
of the pull-down samples after 2 hr of labelling. The relation between
different groups, i.e. "total_fraction", "pull_down.2hr" etc., is
not known and must be recovered during fitting as <code>normFactors</code> values.
If spike-ins are provided, the relation between different fractions
is recovered during the initialisation of the <code>PulseData</code> object and
the values are written to the <code>depthNormalisation</code> slot.</p></li>
<li><p><code>interSampleCoeffs</code> is a list, which structure is used as a sekeleton for the
normalisation factors, if no spike-ins were provided. For every group in
<code>groups</code>, there is a corresponding list item (a number of a numeric vector).</p></li>
<li><p><code>interSampleIndexes</code> describes which normalisation factors to use during
calculation of the mean read count in every sample (an index in the
<code>unlist(interSampleCoeffs)</code>)</p></li>
</ul>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <code>conditions</code> argument may include additional  columns, which
provide values for known parameters, such as time. Their name must be the
same as defined in formulas. For example, if a formula is defined as
<code>mu * exp(-d * time)</code> where <code>time</code> is the time point of the experiment,
the condition data.frame must contain a column named <code>time</code>, otherwise <code>time</code>
is treated as a parameter to fit!</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>


<span class='no'>formulaIndexes</span> <span class='kw'>&lt;-</span> <span class='fu'>list</span>(
  <span class='kw'>total_fraction</span> <span class='kw'>=</span> <span class='st'>'total'</span>,
  <span class='kw'>flow_through</span>   <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>'unlabelled'</span>, <span class='st'>'labelled'</span>),
  <span class='kw'>pull_down</span>      <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>'labelled'</span>, <span class='st'>'unlabelled'</span>))

<span class='co'># Spike-ins definition for object creation</span>
<span class='no'>refGroup</span> <span class='kw'>&lt;-</span> <span class='st'>"total_fraction"</span>

<span class='no'>labelled</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='st'>"spike1"</span>, <span class='st'>"spike2"</span>)
<span class='no'>unlabelled</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='st'>"spike3"</span>, <span class='st'>"spike4"</span>)

<span class='no'>spikeLists</span> <span class='kw'>&lt;-</span> <span class='fu'>list</span>(
<span class='co'># total samples are normalised using all spike-ins</span>
  <span class='kw'>total_fraction</span> <span class='kw'>=</span> <span class='fu'>list</span>(<span class='fu'>c</span>(<span class='no'>unlabelled</span>, <span class='no'>labelled</span>)),
<span class='co'># for every item in formulaIndexes we have a set of spike-ins:</span>
  <span class='kw'>flow_through</span>   <span class='kw'>=</span> <span class='fu'>list</span>(<span class='no'>unlabelled</span>, <span class='no'>labelled</span>),
  <span class='kw'>pull_down</span>      <span class='kw'>=</span> <span class='fu'>list</span>(<span class='no'>labelled</span>, <span class='no'>unlabelled</span>))

<span class='co'># argument for the function:</span>
<span class='no'>spikeins</span> <span class='kw'>&lt;-</span> <span class='fu'>list</span>(<span class='kw'>refGroup</span> <span class='kw'>=</span> <span class='no'>refGroup</span>,
                 <span class='kw'>spikeLists</span> <span class='kw'>=</span> <span class='no'>spikeLists</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Alexey Uvarovskii.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

